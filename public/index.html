<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ® WebRTC í™”ë©´ ê³µìœ  ì‹œìŠ¤í…œ</title>
    
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: Arial, sans-serif; background: #f5f5f5; color: #333; line-height: 1.6; }
        .container { max-width: 1200px; margin: 0 auto; padding: 20px; }
        header { text-align: center; margin-bottom: 30px; background: #fff; padding: 20px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        header h1 { color: #2c3e50; margin-bottom: 10px; }
        header p { color: #7f8c8d; font-size: 16px; }
        
        .controls { background: #fff; padding: 25px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); margin-bottom: 20px; }
        .section { margin-bottom: 25px; }
        .section h3 { color: #2c3e50; margin-bottom: 15px; font-size: 18px; }
        
        .quality-options { margin-bottom: 15px; }
        .quality-options label { font-weight: bold; margin-right: 10px; }
        .quality-options select { padding: 8px; border: 1px solid #ddd; border-radius: 5px; font-size: 14px; }
        
        .control-buttons { display: flex; gap: 10px; }
        .primary-btn { background: #3498db; color: white; border: none; padding: 12px 20px; border-radius: 5px; font-size: 16px; cursor: pointer; transition: background 0.3s; }
        .primary-btn:hover { background: #2980b9; }
        .stop-btn { background: #e74c3c; color: white; border: none; padding: 12px 20px; border-radius: 5px; font-size: 16px; cursor: pointer; }
        .stop-btn:hover { background: #c0392b; }
        .secondary-btn { background: #95a5a6; color: white; border: none; padding: 8px 15px; border-radius: 5px; cursor: pointer; }
        .secondary-btn:hover { background: #7f8c8d; }
        
        .link-container { display: flex; gap: 10px; margin-bottom: 10px; }
        .link-container input { flex: 1; padding: 10px; border: 1px solid #ddd; border-radius: 5px; font-size: 14px; }
        
        .status-section { background: #fff; padding: 20px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); margin-bottom: 20px; }
        .status { padding: 15px; background: #f8f9fa; border-radius: 5px; font-size: 16px; text-align: center; font-weight: bold; }
        
        .hidden { display: none !important; }
        .success-message { color: #27ae60; font-weight: bold; padding: 5px 0; }
        
        /* ì‹œì²­ì ëª¨ë“œ ìŠ¤íƒ€ì¼ */
        .viewer-only { min-height: 100vh; background: #000; }
        .viewer-container { max-width: none; height: 100vh; display: flex; flex-direction: column; }
        .viewer-controls-layout { flex: 1; display: flex; flex-direction: column; }
        .volume-fullscreen-controls { display: flex; justify-content: space-between; align-items: center; padding: 10px; background: rgba(0,0,0,0.8); }
        .volume-control { display: flex; align-items: center; gap: 10px; color: white; }
        .volume-control input { width: 100px; }
        .video-section { flex: 1; position: relative; }
        #remoteVideo { width: 100%; height: 100%; object-fit: contain; background: #000; }
        
        .loading-overlay { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); text-align: center; color: white; z-index: 10; }
        .loading-spinner { border: 3px solid #333; border-top: 3px solid #fff; border-radius: 50%; width: 40px; height: 40px; animation: spin 2s linear infinite; margin: 0 auto 15px; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        
        .buffering-overlay { position: absolute; top: 20px; right: 20px; background: rgba(0,0,0,0.8); color: white; padding: 10px; border-radius: 5px; }
        .buffering-spinner { width: 20px; height: 20px; border: 2px solid #333; border-top: 2px solid #fff; border-radius: 50%; animation: spin 1s linear infinite; margin: 0 auto 5px; }
        
        .compact-status { position: absolute; bottom: 10px; left: 10px; background: rgba(0,0,0,0.8); color: white; padding: 5px 10px; border-radius: 3px; font-size: 12px; }
    </style>
    
    <!-- êµ¬ë²„ì „ ë¸Œë¼ìš°ì € í˜¸í™˜ì„±ì„ ìœ„í•œ polyfill -->
    <script>
        // Promise polyfill for IE11
        if (!window.Promise) {
            document.write('<script src="https://cdn.jsdelivr.net/npm/es6-promise@4/dist/es6-promise.auto.min.js"><\/script>');
        }
        // Object.assign polyfill for IE
        if (!Object.assign) {
            Object.assign = function(target, varArgs) {
                if (target == null) throw new TypeError('Cannot convert undefined or null to object');
                var to = Object(target);
                for (var index = 1; index < arguments.length; index++) {
                    var nextSource = arguments[index];
                    if (nextSource != null) {
                        for (var nextKey in nextSource) {
                            if (Object.prototype.hasOwnProperty.call(nextSource, nextKey)) {
                                to[nextKey] = nextSource[nextKey];
                            }
                        }
                    }
                }
                return to;
            };
        }
    </script>
    
    <!-- WebRTC adapter for cross-browser compatibility -->
    <script src="https://webrtc.github.io/adapter/adapter-latest.js"></script>
</head>
<body>
    <div class="container">
        <header>
            <h1>ğŸ® WebRTC í™”ë©´ ê³µìœ  ì‹œìŠ¤í…œ</h1>
            <p>ğŸ² Tabletop Simulator ì „ìš© í™”ë©´ ê³µìœ  - ì €ì§€ì—° & ê³ í’ˆì§ˆ</p>
        </header>

        <!-- í˜¸ìŠ¤íŠ¸ í™”ë©´ -->
        <div id="hostControls">
            <div class="controls">
                <div class="section share-section">
                    <h3>ğŸ–¥ï¸ í™”ë©´ ê³µìœ </h3>
                    
                    <div class="quality-options">
                        <label for="qualitySelect">ğŸ“º í•´ìƒë„:</label>
                        <select id="qualitySelect">
                            <option value="720p" selected>720p (1280x720)</option>
                            <option value="1080p">1080p (1920x1080)</option>
                        </select>
                    </div>

                    <div class="quality-options">
                        <label for="framerateSelect">ğŸ¬ í”„ë ˆì„ë ˆì´íŠ¸:</label>
                        <select id="framerateSelect">
                            <option value="15">15fps (ì €ì „ë ¥)</option>
                            <option value="24">24fps (ì˜í™”ê¸‰)</option>
                            <option value="30" selected>30fps (ê¶Œì¥)</option>
                            <option value="60">60fps (ê³ í’ˆì§ˆ)</option>
                        </select>
                    </div>

                    <div class="quality-options">
                        <label for="bitrateSelect">ğŸŒ ë¹„íŠ¸ë ˆì´íŠ¸:</label>
                        <select id="bitrateSelect">
                            <option value="500">500 Kbps (ì´ˆì €ì† ë„¤íŠ¸ì›Œí¬)</option>
                            <option value="800">800 Kbps (ì €ì† ë„¤íŠ¸ì›Œí¬)</option>
                            <option value="1200" selected>1.2 Mbps (ê¶Œì¥)</option>
                            <option value="2000">2.0 Mbps (ê³ í’ˆì§ˆ)</option>
                            <option value="3000">3.0 Mbps (ìµœê³ í’ˆì§ˆ)</option>
                            <option value="5000">5.0 Mbps (ê·¹ê³ í’ˆì§ˆ)</option>
                        </select>
                        <div style="font-size: 12px; color: #666; margin-top: 5px;">
                            ğŸ’¡ ê¶Œì¥: 1.2 Mbps (ì•ˆì •ì ) | 2.0 Mbps ì´ìƒì€ ë¹ ë¥¸ ì¸í„°ë„· í•„ìš”
                        </div>
                    </div>
                    
                    <div class="control-buttons">
                        <button class="primary-btn" id="startButton">í™”ë©´ ê³µìœ  ì‹œì‘</button>
                        <button class="stop-btn hidden" id="stopButton">ê³µìœ  ì¤‘ì§€</button>
                    </div>
                </div>

                <div class="section info-section" id="linkSection">
                    <h3>ğŸ”— ì°¸ê°€ì ë§í¬</h3>
                    <div class="link-container">
                        <input type="text" id="viewerLink" readonly placeholder="í™”ë©´ ê³µìœ ë¥¼ ì‹œì‘í•˜ë©´ ë§í¬ê°€ ìƒì„±ë©ë‹ˆë‹¤">
                        <button class="secondary-btn" id="copyLink">ğŸ“‹ ë³µì‚¬</button>
                    </div>
                    <div id="linkSuccess" class="success-message hidden">
                        âœ… ë§í¬ê°€ í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!
                    </div>
                </div>
            </div>

            <div class="status-section">
                <div class="status" id="hostStatus">í™”ë©´ ê³µìœ ë¥¼ ì‹œì‘í•´ì£¼ì„¸ìš”.</div>
            </div>
        </div>

        <!-- ì‹œì²­ì í™”ë©´ -->
        <div id="viewerControls" class="viewer-only hidden">
            <div class="container viewer-container">
                <div class="viewer-controls-layout">
                    <div class="volume-fullscreen-controls">
                        <div class="volume-control">
                            <label for="volumeSlider">ë³¼ë¥¨:</label>
                            <input type="range" id="volumeSlider" min="0" max="100" value="50">
                            <span id="volumeValue">50%</span>
                            <button id="muteBtn" onclick="toggleMute()">ğŸ”Š</button>
                        </div>
                        
                        <div class="fullscreen-control">
                            <button class="secondary-btn" id="fullscreenBtn" onclick="toggleFullscreen()">â›¶ ì „ì²´í™”ë©´</button>
                        </div>
                    </div>

                    <div class="video-section">
                        <div class="loading-overlay" id="loadingOverlay">
                            <div class="loading-spinner"></div>
                            <div class="loading-text">í˜¸ìŠ¤íŠ¸ ì—°ê²° ì¤‘...</div>
                            <div class="loading-bar">
                                <div class="loading-progress" id="loadingProgress"></div>
                            </div>
                        </div>
                        
                        <div class="buffering-overlay hidden" id="bufferingOverlay">
                            <div class="buffering-spinner"></div>
                            <div class="buffering-text">ë²„í¼ë§ ì¤‘...</div>
                        </div>
                        
                        <video id="remoteVideo" autoplay playsinline></video>
                        <div class="status compact-status" id="viewerStatus">í˜¸ìŠ¤íŠ¸ì˜ í™”ë©´ ê³µìœ ë¥¼ ê¸°ë‹¤ë¦¬ëŠ” ì¤‘...</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="/socket.io/socket.io.js"></script>
    <script src="/js/main.js"></script>
</body>
</html> 